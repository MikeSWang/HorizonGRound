
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Clustering modification (clustering_modification) &#8212; HorizonGRound 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Luminosity function likelihood (lumfunc_likelihood)" href="horizonground.lumfunc_likelihood.html" />
    <link rel="prev" title="API Reference" href="apidoc.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HorizonGRound.png" alt="Logo"/>
            </a></p><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quick_recipes.html">Quick Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="apidoc.html">API Reference</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-horizonground.clustering_modification"></span><div class="section" id="clustering-modification-clustering-modification">
<h1>Clustering modification (<a class="reference internal" href="#module-horizonground.clustering_modification" title="horizonground.clustering_modification"><code class="xref py py-mod docutils literal notranslate"><span class="pre">clustering_modification</span></code></a>)<a class="headerlink" href="#clustering-modification-clustering-modification" title="Permalink to this headline">¶</a></h1>
<p>Compute modifications to the Newtonian power spectrum in the
distant-observer and plane-parallel limits.</p>
<div class="section" id="standard-kaiser-rsd-model">
<h2>Standard Kaiser RSD model<a class="headerlink" href="#standard-kaiser-rsd-model" title="Permalink to this headline">¶</a></h2>
<p>Redshift-space distortions induce anisotropy in the power spectrum
multipoles</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    P_0(k, z) &amp;=
        \left[
            b_1(z)^2 + \frac{2}{3} b_1(z) f(z) + \frac{1}{5} f(z)^2
        \right] P_\mathrm{m}(k, z) \,, \\
    P_2(k, z) &amp;=
        \left[
            \frac{4}{3} b_1(z) f(z) + \frac{4}{7} f(z)^2
        \right] P_\mathrm{m}(k, z) \,, \\
    P_4(k, z) &amp;= \frac{8}{35} f(z)^2 P_\mathrm{m}(k, z) \,
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_\mathrm{m}\)</span> is the matter power spectrum, <span class="math notranslate nohighlight">\(b_1(z)\)</span> is
the linear bias and <span class="math notranslate nohighlight">\(f(z)\)</span> is the linear growth rate.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.clustering_modification.standard_kaiser_factor" title="horizonground.clustering_modification.standard_kaiser_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standard_kaiser_factor</span></code></a>(order, bias, redshift)</p></td>
<td><p>Compute the standard Kaiser power spectrum multipoles as multiples of the matter power spectrum, i.e.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="non-gaussianity-scale-dependent-modifications">
<h2>Non-Gaussianity scale-dependent modifications<a class="headerlink" href="#non-gaussianity-scale-dependent-modifications" title="Permalink to this headline">¶</a></h2>
<p>Local primordial non-Gaussianty <span class="math notranslate nohighlight">\(f_\mathrm{NL}\)</span> induces scale
dependence in the linear bias,</p>
<div class="math notranslate nohighlight">
\[b_1(z) \mapsto b_1(z) + \Delta b_k(z) \,, \quad
\Delta b(k, z) = f_\mathrm{NL} [b_1(z) - p] \frac{A(k, z)}{k^2} \,,\]</div>
<p>where the scale-dependence kernel is</p>
<div class="math notranslate nohighlight">
\[A(k, z) = 3 \left( \frac{H_0}{\mathrm{c}} \right)^2
    \frac{1.27 \varOmega_\mathrm{m,0} \delta_\mathrm{c}}{D(z)T(k)} \,.\]</div>
<p>Here <span class="math notranslate nohighlight">\(H_0\)</span> is the Hubble parameter at the current epoch
(in km/s/Mpc), <span class="math notranslate nohighlight">\(\mathrm{c}\)</span> the speed of light,
<span class="math notranslate nohighlight">\(\varOmega_\mathrm{m,0}\)</span> the matter density parameter at the current
epoch, and <span class="math notranslate nohighlight">\(\delta_\mathrm{c}\)</span> the critical over-density in
spherical gravitational collapse.  The growth factor <span class="math notranslate nohighlight">\(D(z)\)</span> is
normalised to unity at the current epoch (thus the numerical factor 1.27),
the transfer function <span class="math notranslate nohighlight">\(T(k)\)</span> is normalised to unity as
<span class="math notranslate nohighlight">\(k \to 0\)</span>, and <span class="math notranslate nohighlight">\(p\)</span> is a tracer-dependent parameter.</p>
<p>Modifications to power spectrum multipoles as a result of local primordial
non-Gaussianty are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \Delta P_0(k, z) &amp;= \left[
        \left( 2 b_1 + \frac{2}{3} f \right) \Delta b(k, z)
        + \Delta b(k, z)^2
    \right] P_\mathrm{m}(k, z) \,, \\
    \Delta P_2(k, z) &amp;=
        \frac{4}{3} f \Delta b(k, z) P_\mathrm{m}(k, z) \,.
\end{align*}\end{split}\]</div>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.clustering_modification.scale_dependence_kernel" title="horizonground.clustering_modification.scale_dependence_kernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale_dependence_kernel</span></code></a>(redshift[, cosmo])</p></td>
<td><p>Return the scale-dependence kernel <span class="math notranslate nohighlight">\(A(k, z)\)</span> in the presence of local primordial non-Gaussianity.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#horizonground.clustering_modification.non_gaussianity_correction_factor" title="horizonground.clustering_modification.non_gaussianity_correction_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_gaussianity_correction_factor</span></code></a>(…[, …])</p></td>
<td><p>Compute modifications to the power spectrum multipoles by local primordial non-Gaussianity as multiples of the matter power spectrum, i.e.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="relativistic-corrections">
<h2>Relativistic corrections<a class="headerlink" href="#relativistic-corrections" title="Permalink to this headline">¶</a></h2>
<p>Relativistic corrections to the Newtonian clustering mode</p>
<div class="math notranslate nohighlight">
\[\delta(\mathbf{k}, z)
= b_1(z) \delta_\mathrm{m}(\mathbf{k}, z)
    + g(z) v_{\parallel}(\mathbf{k}, z)
= b_1(z) \delta_\mathrm{m}(\mathbf{k}, z)
    + \mathrm{i} \frac{\mathcal{H}}{k} g(z) f(z) \mu
    \delta_\mathrm{m}(\mathbf{k}, z)\]</div>
<p>are parametrised by the redshift-dependent, dimensionless quantity</p>
<div class="math notranslate nohighlight">
\[g(z) = \frac{\mathcal{H}'}{\mathcal{H}^2}
    + 5s + \frac{2 - 5s}{\mathcal{H} \chi}
    - b_\mathrm{e}\]</div>
<p>with evolution bias <span class="math notranslate nohighlight">\(b_\mathrm{e}(z)\)</span> and magnification bias
<span class="math notranslate nohighlight">\(s(z)\)</span>, where <span class="math notranslate nohighlight">\(v_{\parallel}\)</span> is the line-of-sight peculiar
velocity, <span class="math notranslate nohighlight">\(\chi(z)\)</span> is the comoving distance and <span class="math notranslate nohighlight">\('\)</span> denotes
derivatives with respect to the conformal time. This can be written as the
sum of three contributions</p>
<div class="math notranslate nohighlight">
\[g(z) = \underbrace{\left[
    1
    - \frac{3}{2} \frac{H_0^2}{H(z)^2} \varOmega_\mathrm{m,0} (1 + z)^3
    + \frac{2}{\mathcal{H}\chi}
\right]}_{\text{background expansion}}
\underbrace{- b_\mathrm{e}(z)}_{\text{evolution}}
+ \underbrace{
    5s(z) \left( 1 - \frac{1}{\mathcal{H}\chi} \right)
}_{\text{magnification}} \,.\]</div>
<p>Modifications to power spectrum multipoles from the relativistic
corrections are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \Delta P_0(k, z) &amp;= \frac{1}{3} \frac{\mathcal{H}^2}{k^2}
        g(z)^2 f(z)^2 P_\mathrm{m}(k,z) \,,\\
    \Delta P_2(k, z) &amp;= \frac{2}{3} \frac{\mathcal{H}^2}{k^2}
        g(z)^2 f(z)^2 P_\mathrm{m}(k,z) \,,
\end{align*}\end{split}\]</div>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.clustering_modification.relativistic_correction_func" title="horizonground.clustering_modification.relativistic_correction_func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relativistic_correction_func</span></code></a>([cosmo, …])</p></td>
<td><p>Return the relativistic correction function as <span class="math notranslate nohighlight">\(\mathcal{H} g(z)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#horizonground.clustering_modification.relativistic_correction_value" title="horizonground.clustering_modification.relativistic_correction_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relativistic_correction_value</span></code></a>(redshift[, …])</p></td>
<td><p>Evaluate the relativistic correction function <span class="math notranslate nohighlight">\(\mathcal{H} g(z)\)</span> at a given redshift.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.clustering_modification.relativistic_correction_factor" title="horizonground.clustering_modification.relativistic_correction_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relativistic_correction_factor</span></code></a>(wavenumber, …)</p></td>
<td><p>Compute modifications to the power spectrum multipoles by relativistic corrections as multiples of the matter power spectrum, i.e.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="data">
<dt id="horizonground.clustering_modification.FIDUCIAL_COSMOLOGY">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">FIDUCIAL_COSMOLOGY</code><em class="property"> = &lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em><a class="headerlink" href="#horizonground.clustering_modification.FIDUCIAL_COSMOLOGY" title="Permalink to this definition">¶</a></dt>
<dd><p>Default Planck15 cosmology.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.clustering_modification.standard_kaiser_factor">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">standard_kaiser_factor</code><span class="sig-paren">(</span><em class="sig-param">order</em>, <em class="sig-param">bias</em>, <em class="sig-param">redshift</em>, <em class="sig-param">cosmo=&lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/clustering_modification.html#standard_kaiser_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.clustering_modification.standard_kaiser_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard Kaiser power spectrum multipoles as multiples
of the matter power spectrum, i.e. <span class="math notranslate nohighlight">\(P_\ell/P_\mathrm{m}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – Order of the multipole, <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>bias</strong> (<em>float</em>) – Scale-independent linear bias at <cite>redshift</cite>.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p></li>
<li><p><strong>cosmo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code>, optional) – Cosmological model (default is <code class="docutils literal notranslate"><span class="pre">FIDUCIAL_COSMOLOGY</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>factor</strong> – Power spectrum multipoles as multiples of the matter power
spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.clustering_modification.scale_dependence_kernel">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">scale_dependence_kernel</code><span class="sig-paren">(</span><em class="sig-param">redshift</em>, <em class="sig-param">cosmo=&lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/clustering_modification.html#scale_dependence_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.clustering_modification.scale_dependence_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scale-dependence kernel <span class="math notranslate nohighlight">\(A(k, z)\)</span> in the presence
of local primordial non-Gaussianity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p></li>
<li><p><strong>cosmo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code>, optional) – Cosmological model (default is <code class="docutils literal notranslate"><span class="pre">FIDUCIAL_COSMOLOGY</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scale-dependence kernel as a function of wavenumber (in
<span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.clustering_modification.non_gaussianity_correction_factor">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">non_gaussianity_correction_factor</code><span class="sig-paren">(</span><em class="sig-param">wavenumber</em>, <em class="sig-param">order</em>, <em class="sig-param">local_png</em>, <em class="sig-param">bias</em>, <em class="sig-param">redshift</em>, <em class="sig-param">cosmo=&lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em>, <em class="sig-param">tracer_p=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/clustering_modification.html#non_gaussianity_correction_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.clustering_modification.non_gaussianity_correction_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute modifications to the power spectrum multipoles by local
primordial non-Gaussianity as multiples of the matter power spectrum,
i.e. <span class="math notranslate nohighlight">\(\Delta P_\ell/P_\mathrm{m}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavenumber</strong> (<em>float, array_like</em>) – Wavenumber (in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span>).</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Order of the multipole, <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>local_png</strong> (<em>float</em>) – Local primordial non-Gaussianity.</p></li>
<li><p><strong>bias</strong> (<em>float</em>) – Scale-independent linear bias at <cite>redshift</cite>.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p></li>
<li><p><strong>cosmo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code>, optional) – Base cosmological model (default is <code class="docutils literal notranslate"><span class="pre">FIDUCIAL_COSMOLOGY</span></code>).</p></li>
<li><p><strong>tracer_p</strong> (<em>float, optional</em>) – Tracer parameter (default is 1.).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>factor</strong> – Power spectrum multipole modifications as multiples of the matter
power spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.clustering_modification.relativistic_correction_func">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">relativistic_correction_func</code><span class="sig-paren">(</span><em class="sig-param">cosmo=&lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em>, <em class="sig-param">geometric=True</em>, <em class="sig-param">evolution_bias=None</em>, <em class="sig-param">magnification_bias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/clustering_modification.html#relativistic_correction_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.clustering_modification.relativistic_correction_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relativistic correction function as
<span class="math notranslate nohighlight">\(\mathcal{H} g(z)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cosmo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code>, optional) – Cosmological model (default is <code class="docutils literal notranslate"><span class="pre">FIDUCIAL_COSMOLOGY</span></code>).</p></li>
<li><p><strong>geometric</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default), include geometric contributions from the
background expansion.</p></li>
<li><p><strong>evolution_bias, magnification_bias</strong> (<em>callable or None, optional</em>) – Evolution bias or magnification bias as a function of redshift
(default is <cite>None</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Relativistic correction function as a function of redshift
(in <span class="math notranslate nohighlight">\(h\)</span>/Mpc).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.clustering_modification.relativistic_correction_value">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">relativistic_correction_value</code><span class="sig-paren">(</span><em class="sig-param">redshift</em>, <em class="sig-param">cosmo=&lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em>, <em class="sig-param">geometric=True</em>, <em class="sig-param">evolution_bias=None</em>, <em class="sig-param">magnification_bias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/clustering_modification.html#relativistic_correction_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.clustering_modification.relativistic_correction_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the relativistic correction function
<span class="math notranslate nohighlight">\(\mathcal{H} g(z)\)</span> at a given redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p></li>
<li><p><strong>cosmo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code>, optional) – Base cosmological model (default is <code class="docutils literal notranslate"><span class="pre">FIDUCIAL_COSMOLOGY</span></code>).</p></li>
<li><p><strong>geometric</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default), include geometric contributions from the
background expansion.</p></li>
<li><p><strong>evolution_bias, magnification_bias</strong> (<em>float or None, optional</em>) – Evolution bias or magnification bias evaluated at input <cite>redshift</cite>
(default is <cite>None</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>correction_value</strong> – Relativistic correction function value (in <span class="math notranslate nohighlight">\(h\)</span>/Mpc)
at <cite>redshift</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.clustering_modification.relativistic_correction_factor">
<code class="sig-prename descclassname">horizonground.clustering_modification.</code><code class="sig-name descname">relativistic_correction_factor</code><span class="sig-paren">(</span><em class="sig-param">wavenumber</em>, <em class="sig-param">order</em>, <em class="sig-param">redshift</em>, <em class="sig-param">correction_value=None</em>, <em class="sig-param">cosmo=&lt;nbodykit.cosmology.cosmology.Cosmology object&gt;</em>, <em class="sig-param">geometric=True</em>, <em class="sig-param">evolution_bias=None</em>, <em class="sig-param">magnification_bias=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/clustering_modification.html#relativistic_correction_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.clustering_modification.relativistic_correction_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute modifications to the power spectrum multipoles by
relativistic corrections as multiples of the matter power spectrum,
i.e. <span class="math notranslate nohighlight">\(\Delta P_\ell/P_\mathrm{m}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavenumber</strong> (<em>float, array_like</em>) – Wavenumber (in <span class="math notranslate nohighlight">\(h/\mathrm{Mpc}\)</span>).</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Order of the multipole, <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p></li>
<li><p><strong>correction_value</strong> (<em>float or None, optional</em>) – If not <cite>None</cite> (default), this is directly used as
<span class="math notranslate nohighlight">\(\mathcal{H} g(z)\)</span> at <cite>redshift</cite> in calculations, and
<cite>cosmo</cite>, <cite>geometric</cite>, <cite>evolution_bias</cite> and <cite>magnification_bias</cite>
are ignored.</p></li>
<li><p><strong>cosmo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">nbodykit.cosmology.Cosmology</span></code>, optional) – Cosmological model (default is <code class="docutils literal notranslate"><span class="pre">FIDUCIAL_COSMOLOGY</span></code>).</p></li>
<li><p><strong>geometric</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default), include geometric contributions from the
background expansion.</p></li>
<li><p><strong>evolution_bias</strong> (<em>float or callable or None, optional</em>) – Evolution bias as a function of redshift, or evaluated at input
<cite>redshift</cite> (default is <cite>None</cite>).  If callable/float,
<cite>magnification_bias</cite> must also be callable/float.</p></li>
<li><p><strong>magnification_bias</strong> (<em>float or callable or None, optional</em>) – Magnification bias as a function of redshift, or evaluated at input
<cite>redshift</cite> (default is <cite>None</cite>).  If callable/float,
<cite>evolution_bias</cite> must also be callable/float.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>factor</strong> – Power spectrum multipoles as multiples of the matter power
spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy; Copyright 2020, Mike Shengbo Wang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/horizonground.clustering_modification.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>