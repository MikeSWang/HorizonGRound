
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Luminosity function modeller (lumfunc_modeller) &#8212; HorizonGRound 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Luminosity function likelihood (lumfunc_likelihood)" href="horizonground.lumfunc_likelihood.html" />
    <link rel="prev" title="API Reference" href="apidoc.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HorizonGRound.png" alt="Logo"/>
            </a></p><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quick_recipes.html">Quick Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="apidoc.html">API Reference</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-horizonground.lumfunc_modeller"></span><div class="section" id="luminosity-function-modeller-lumfunc-modeller">
<h1>Luminosity function modeller (<a class="reference internal" href="#module-horizonground.lumfunc_modeller" title="horizonground.lumfunc_modeller"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lumfunc_modeller</span></code></a>)<a class="headerlink" href="#luminosity-function-modeller-lumfunc-modeller" title="Permalink to this headline">¶</a></h1>
<p>Provide models of the redshift-dependent tracer luminosity function
<span class="math notranslate nohighlight">\(\varPhi(m, z)\)</span> (for absolute magnitude <span class="math notranslate nohighlight">\(m\)</span>) or
<span class="math notranslate nohighlight">\(\varPhi(\lg{L}, z)\)</span> (for base-10 logarithm of the intrinsic
luminosity <span class="math notranslate nohighlight">\(L\)</span>), from which the comoving number density below/above
some brightness threshold <span class="math notranslate nohighlight">\(\bar{m}\)</span> or <span class="math notranslate nohighlight">\(\bar{L}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\bar{n}(z; &lt;\!\bar{m}) = \int_{-\infty}^{\bar{m}}
    \operatorname{d}\!m\, \varPhi(m, z)
\quad \mathrm{or} \quad
\bar{n}(z; &gt;\!\lg\bar{L}) = \int^{\infty}_{\lg\bar{L}}
    \operatorname{d}\!\lg{L}\, \varPhi(\lg{L}, z) \,,\]</div>
<p>can be predicted.  The corresponding evolution bias is</p>
<div class="math notranslate nohighlight">
\[b_\mathrm{e}(z) = - (1 + z)
    \frac{\partial \ln\bar{n}(z)}{\partial z}\]</div>
<p>and magnification bias is</p>
<div class="math notranslate nohighlight">
\[s(z) = \frac{1}{\ln10}
    \frac{\varPhi(\bar{m},z)}{\bar{n}(z; &lt;\!\bar{m})}
\quad \mathrm{or} \quad
s(z) = \frac{2}{5\ln10}
    \frac{\varPhi(\lg\bar{L},z)}{\bar{n}(z; &gt;\!\lg\bar{L})}
\,,\]</div>
<p>We also offer a simple <span class="math notranslate nohighlight">\(K\)</span>-correction formula taken from ref. <a class="footnote-reference brackets" href="#id2" id="id1">1</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Croom S. M. et al., 2009. <strong>MNRAS</strong> 399(4), 1755–1772.
[arXiv: <a class="reference external" href="https://arxiv.org/abs/0907.2727">0907.2727</a>]</p>
</dd>
</dl>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.LumFuncModeller" title="horizonground.lumfunc_modeller.LumFuncModeller"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LumFuncModeller</span></code></a>(model_lumfunc, …[, …])</p></td>
<td><p>Luminosity function modeller predicting the comoving number density, evolution bias and magnification bias for a given brightness threshold.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.konstante_correction" title="horizonground.lumfunc_modeller.konstante_correction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">konstante_correction</span></code></a>(redshift[, …])</p></td>
<td><p>Subtractive Konstante correction (<em>K</em>-correction) to apparent magnitude for correcting bandpass redshifting.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="quasar-qso-luminosity-function">
<h2>Quasar (QSO) luminosity function<a class="headerlink" href="#quasar-qso-luminosity-function" title="Permalink to this headline">¶</a></h2>
<p><strong>Pure luminosity evolution model (PLE)</strong></p>
<p>The quasar luminosity function in the pure luminosity evolution (PLE)
model is a double power law</p>
<div class="math notranslate nohighlight">
\[\varPhi(m, z) = \frac{\varPhi_\ast}{
    10^{0.4 (\alpha + 1) [m - m_\ast(z)]}
    + 10^{0.4 (\beta + 1) [m - m_\ast(z)]}
}\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the absolute magnitude, <span class="math notranslate nohighlight">\(z\)</span> is the redshift, and
the slope parameters <span class="math notranslate nohighlight">\(\alpha, \beta\)</span> describe the power laws on the
bright and faint ends respectively, but their values differ below and
above the pivot redshift <span class="math notranslate nohighlight">\(z_\mathrm{p}\)</span>.  <span class="math notranslate nohighlight">\(m_\ast\)</span> is the
break magnitude at which the luminosity function evaluates to
<span class="math notranslate nohighlight">\(\varPhi_\ast\)</span>,</p>
<div class="math notranslate nohighlight">
\[m_\ast(z) = m_\ast(z_\mathrm{p}) - \frac{5}{2} \left[
    k_1 (z - z_\mathrm{p}) + k_2 (z - z_\mathrm{p})^2
\right] \,,\]</div>
<p>where <span class="math notranslate nohighlight">\(k_1, k_2\)</span> are the redshift-evolution parameters whose values
also differ below and above the pivot redshift <a class="footnote-reference brackets" href="#id6" id="id4">2</a>.</p>
<p>This is a parametric model with 10 parameters: <span class="math notranslate nohighlight">\(\lg\varPhi_\ast\)</span>,
<span class="math notranslate nohighlight">\(m_\ast(z_\mathrm{p})\)</span>, <span class="math notranslate nohighlight">\((\alpha, \beta, k_1, k_2)_\mathrm{l}\)</span>
for <span class="math notranslate nohighlight">\(z &lt; z_\mathrm{p}\)</span> and <span class="math notranslate nohighlight">\((\alpha, \beta, k_1,
k_2)_\mathrm{h}\)</span> for <span class="math notranslate nohighlight">\(z &gt; z_\mathrm{p}\)</span>.   Due to the exchange
symmetry between <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> in the double power law,
the model constraint <span class="math notranslate nohighlight">\(\alpha &lt; \beta\)</span> is imposed for both above
and below the pivot redshift.</p>
<p><strong>Hybrid evolution model (PLE+LEDE)</strong></p>
<p>This model is the same as the PLE model below the pivot redshift, but
above that the luminosity evolution–density evolution (LEDE) model is
adopted where the luminosity function normalisation, break magnitude and
bright-end power law index have different redshift evolutions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \lg\varPhi_\ast &amp;= \lg\varPhi_\ast(z_\mathrm{p}) \
        + c_{1\mathrm{a}} (z - z_\mathrm{p})
        + c_{1\mathrm{b}} (z - z_\mathrm{p})^2 \,, \\
    m_\ast(z) &amp;= m_\ast(z_\mathrm{p}) + c_2 (z - z_\mathrm{p}) \,, \\
    \alpha(z) &amp;= \alpha(z_\mathrm{p}) + c_3 (z - z_\mathrm{p}) \,,
\end{align*}\end{split}\]</div>
<p>and continuity across redshift is imposed by requiring the same
<span class="math notranslate nohighlight">\(\lg\varPhi_\ast(z_\mathrm{p})\)</span> and <span class="math notranslate nohighlight">\(m_\ast(z_\mathrm{p})\)</span> for
two models <a class="footnote-reference brackets" href="#id6" id="id5">2</a>.</p>
<p>The hybrid model still has 10 overall parameters: the PLE model retains 6
low-redshift parameters and the high-redshift LEDE model has 8 parameters,
with the substitutions of <span class="math notranslate nohighlight">\(\lg\varPhi_\ast(0)\)</span> for
<span class="math notranslate nohighlight">\(\lg\varPhi_\ast\)</span>, <span class="math notranslate nohighlight">\(m_\ast(0)\)</span> for
<span class="math notranslate nohighlight">\(m_\ast(z_\mathrm{p})\)</span>, <span class="math notranslate nohighlight">\(c_2\)</span> for <span class="math notranslate nohighlight">\(k_1, k_2\)</span> and the
addition of <span class="math notranslate nohighlight">\(c_{1\mathrm{a}}, c_{1\mathrm{b}}\)</span> and <span class="math notranslate nohighlight">\(c_3\)</span>.
As before, due to the exchange symmetry between <span class="math notranslate nohighlight">\(\alpha\)</span> and
<span class="math notranslate nohighlight">\(\beta\)</span>, the low-redshift PLE model constraint <span class="math notranslate nohighlight">\(\alpha &lt; \beta\)</span>
is imposed.</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets">2</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>Palanque-Delabrouille N. et al., 2016. <strong>A&amp;A</strong> 587, A41.
[arXiv: <a class="reference external" href="https://arxiv.org/abs/1509.05607">1509.05607</a>]</p>
</dd>
</dl>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.quasar_PLE_lumfunc" title="horizonground.lumfunc_modeller.quasar_PLE_lumfunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quasar_PLE_lumfunc</span></code></a>(magnitude, redshift, *[, …])</p></td>
<td><p>Evaluate the pure luminosity evolution (PLE) model for the quasar luminosity function at the given absolute magnitude and redshift.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.quasar_PLE_model_constraint" title="horizonground.lumfunc_modeller.quasar_PLE_model_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quasar_PLE_model_constraint</span></code></a>(**model_parameters)</p></td>
<td><p>Check whether the pure luminosity evolution (PLE) model constraint is satisfied.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.quasar_hybrid_lumfunc" title="horizonground.lumfunc_modeller.quasar_hybrid_lumfunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quasar_hybrid_lumfunc</span></code></a>(magnitude, redshift, *)</p></td>
<td><p>Evaluate the hybrid model (pure luminosity evolution and luminosity evolution–density evolution, ‘PLE+LEDE’) for the quasar luminosity function at the given absolute magnitude and redshift.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.quasar_hybrid_model_constraint" title="horizonground.lumfunc_modeller.quasar_hybrid_model_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quasar_hybrid_model_constraint</span></code></a>(…)</p></td>
<td><p>Check whether the hybrid model constraint is satisfied.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="h-alpha-emitter-luminosity-function">
<h2>Hα-emitter luminosity function<a class="headerlink" href="#h-alpha-emitter-luminosity-function" title="Permalink to this headline">¶</a></h2>
<p><strong>Schechter function model</strong></p>
<p>The Hα-emitter luminosity function in the Schechter function model
takes the form of a gamma function</p>
<div class="math notranslate nohighlight">
\[\varPhi(L, z) \operatorname{d}\!L = \underbrace{
    \ln10 \, \varPhi_\ast(z) y(z)^{\alpha+1} \mathrm{e}^{-y(z)}
}_{\varPhi(\lg{L}, z)} \operatorname{d}\!\lg{L}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the faint-end slope parameter,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \varPhi_\ast(z) &amp;=
        \begin{cases}
            \varPhi_{\ast0} (1 + z)^\epsilon \,,
                \quad z \leqslant z_\mathrm{b} \,; \\
            \varPhi_{\ast0} (1 + z_\mathrm{b})^{2\epsilon}
                (1 + z)^{-\epsilon} \,, \quad z &gt; z_\mathrm{b} \,,
        \end{cases} \\
    y(z) &amp;= \frac{L}{L_{\ast0}} (1 + z)^{-\delta} \,,
\end{align*}\end{split}\]</div>
<p>are the redshift-dependent characteristic comoving number density and
relative luminosity of the Hα-emitters, <span class="math notranslate nohighlight">\(\epsilon, \delta\)</span>
are the redshift-evolution indices, and <span class="math notranslate nohighlight">\(z_\mathrm{b}\)</span> is the break
magnitude <a class="footnote-reference brackets" href="#id9" id="id8">3</a>.</p>
<p>This is a parametric model with 6 parameters: <span class="math notranslate nohighlight">\(\alpha, \epsilon,
\delta\)</span>, <span class="math notranslate nohighlight">\(z_\mathrm{b}\)</span>, <span class="math notranslate nohighlight">\(m_{\ast0}\)</span> and
<span class="math notranslate nohighlight">\(\varPhi_{\ast0}\)</span>.</p>
<dl class="footnote brackets">
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id8">3</a></span></dt>
<dd><p>Pozzetti L. et al., 2016. <strong>A&amp;A</strong> 590, A3.
[arXiv: <a class="reference external" href="https://arxiv.org/abs/1603.01453">1603.01453</a>]</p>
</dd>
</dl>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#horizonground.lumfunc_modeller.alpha_emitter_schechter_lumfunc" title="horizonground.lumfunc_modeller.alpha_emitter_schechter_lumfunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha_emitter_schechter_lumfunc</span></code></a>(luminosity, …)</p></td>
<td><p>Evaluate the Schechter model for the Hα-emitter luminosity function at the given intrinsic luminosity and redshift.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="function">
<dt id="horizonground.lumfunc_modeller.konstante_correction">
<code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">konstante_correction</code><span class="sig-paren">(</span><em class="sig-param">redshift</em>, <em class="sig-param">normalisation_redshift=2.0</em>, <em class="sig-param">index=-0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#konstante_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.konstante_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtractive Konstante correction (<em>K</em>-correction) to apparent
magnitude for correcting bandpass redshifting.</p>
<p class="rubric">Notes</p>
<p>This implements the subtractive <em>K</em>-correction <span class="math notranslate nohighlight">\(K(z) - K(z_\ast)\)</span>
normalised to redshift <span class="math notranslate nohighlight">\(z_\ast\)</span>, where</p>
<div class="math notranslate nohighlight">
\[K(z) = - \frac{5}{2} (1 + \alpha_\nu) \lg(1 + z)\]</div>
<p>and <span class="math notranslate nohighlight">\(\alpha_\nu\)</span> is the power-law index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p></li>
<li><p><strong>normalisation_redshift</strong> (<em>float, optional</em>) – Normalisation redshift (default is 2.).</p></li>
<li><p><strong>index</strong> (<em>float, optional</em>) – <span class="math notranslate nohighlight">\(K\)</span>-correction power-law index (default is -0.5).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>correction_magnitude</strong> – The magnitude correction that needs to be subtracted from the
observed magnitude.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.lumfunc_modeller.quasar_PLE_lumfunc">
<code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">quasar_PLE_lumfunc</code><span class="sig-paren">(</span><em class="sig-param">magnitude</em>, <em class="sig-param">redshift</em>, <em class="sig-param">*</em>, <em class="sig-param">base10_log=True</em>, <em class="sig-param">redshift_pivot=2.2</em>, <em class="sig-param">**model_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#quasar_PLE_lumfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.quasar_PLE_lumfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the pure luminosity evolution (PLE) model for the quasar
luminosity function at the given absolute magnitude and redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>magnitude</strong> (<em>float</em>) – Quasar absolute magnitude.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Quasar redshift.</p></li>
<li><p><strong>base10_log</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default), return the base-10 logarithmic value.</p></li>
<li><p><strong>redshift_pivot</strong> (<em>float, optional</em>) – Pivot redshift.</p></li>
<li><p><strong>**model_parameters</strong> – PLE model parameters.  Must be passed with the following
parameter names:
<code class="docutils literal notranslate"><span class="pre">r'\lg\Phi_\ast'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'm_\ast(z_\mathrm{p})'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'\alpha_\mathrm{{l}}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\beta_\mathrm{{l}}'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'k_{{1\mathrm{{l}}}}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'k_{{2\mathrm{{l}}}}'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'\alpha_\mathrm{{h}}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\beta_\mathrm{{h}}'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'k_{{1\mathrm{{h}}}}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'k_{{2\mathrm{{h}}}}'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lumfunc_value</strong> – Predicted qausar luminosity function value (in inverse cubic Mpc
per unit magnitude).  Base-10 logarithmic value is returned if
<cite>base10_log</cite> is <cite>True</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is not vectorised.  Please use <cite>numpy.vectorize</cite> or
<cite>functools</cite> if you need vectorisation.</p>
</dd></dl>

<dl class="function">
<dt id="horizonground.lumfunc_modeller.quasar_PLE_model_constraint">
<code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">quasar_PLE_model_constraint</code><span class="sig-paren">(</span><em class="sig-param">**model_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#quasar_PLE_model_constraint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.quasar_PLE_model_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the pure luminosity evolution (PLE) model constraint
is satisfied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**model_parameters</strong> – PLE model parameters.  See <a class="reference internal" href="#horizonground.lumfunc_modeller.quasar_PLE_lumfunc" title="horizonground.lumfunc_modeller.quasar_PLE_lumfunc"><code class="xref py py-func docutils literal notranslate"><span class="pre">quasar_PLE_lumfunc()</span></code></a> for required
parameters.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether or not the model constraint is satisfied.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.lumfunc_modeller.quasar_hybrid_lumfunc">
<code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">quasar_hybrid_lumfunc</code><span class="sig-paren">(</span><em class="sig-param">magnitude</em>, <em class="sig-param">redshift</em>, <em class="sig-param">*</em>, <em class="sig-param">base10_log=True</em>, <em class="sig-param">redshift_pivot=2.2</em>, <em class="sig-param">**model_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#quasar_hybrid_lumfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.quasar_hybrid_lumfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the hybrid model (pure luminosity evolution and luminosity
evolution–density evolution, ‘PLE+LEDE’) for the quasar luminosity
function at the given absolute magnitude and redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>magnitude</strong> (<em>float</em>) – Quasar absolute magnitude.</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Quasar redshift.</p></li>
<li><p><strong>base10_log</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default), return the base-10 logarithmic value.</p></li>
<li><p><strong>redshift_pivot</strong> (<em>float, optional</em>) – Pivot redshift.</p></li>
<li><p><strong>**model_parameters</strong> – Hybrid model parameters.  Must be passed with the following
parameter names: <code class="docutils literal notranslate"><span class="pre">r'\lg\Phi_\ast(0)'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'm_\ast(0)'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'\alpha'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\beta'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'k_1'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'k_2'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'c_{{1\mathrm{{a}}}}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'c_{{1\mathrm{{b}}}}'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'c_2'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'k_3'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lumfunc_value</strong> – Predicted qausar luminosity function value (in inverse cubic Mpc
per unit magnitude).  Base-10 logarithmic value is returned if
<cite>base10_log</cite> is <cite>True</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is not vectorised.  Please use <cite>numpy.vectorize</cite> or
<cite>functools</cite> if you need vectorisation.</p>
</dd></dl>

<dl class="function">
<dt id="horizonground.lumfunc_modeller.quasar_hybrid_model_constraint">
<code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">quasar_hybrid_model_constraint</code><span class="sig-paren">(</span><em class="sig-param">**model_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#quasar_hybrid_model_constraint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.quasar_hybrid_model_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the hybrid model constraint is satisfied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**model_parameters</strong> – Hybrid model parameters.  See <a class="reference internal" href="#horizonground.lumfunc_modeller.quasar_hybrid_lumfunc" title="horizonground.lumfunc_modeller.quasar_hybrid_lumfunc"><code class="xref py py-func docutils literal notranslate"><span class="pre">quasar_hybrid_lumfunc()</span></code></a> for
required parameters.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether or not the model constraint is satisfied.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horizonground.lumfunc_modeller.alpha_emitter_schechter_lumfunc">
<code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">alpha_emitter_schechter_lumfunc</code><span class="sig-paren">(</span><em class="sig-param">luminosity</em>, <em class="sig-param">redshift</em>, <em class="sig-param">*</em>, <em class="sig-param">base10_log=True</em>, <em class="sig-param">**model_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#alpha_emitter_schechter_lumfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.alpha_emitter_schechter_lumfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the Schechter model for the Hα-emitter
luminosity function at the given intrinsic luminosity and redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>luminosity</strong> (<em>float</em>) – Hα-emitter luminosity in dex (base-10 logarithm).</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Hα-emitter redshift.</p></li>
<li><p><strong>base10_log</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default), return the base-10 logarithmic value.</p></li>
<li><p><strong>**model_parameters</strong> – Schechter model parameters.  Must be passed with the following
parameter names: <code class="docutils literal notranslate"><span class="pre">r'\lg\Phi_{\ast0}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\lg{L_{\ast0}}'</span></code>,
<code class="docutils literal notranslate"><span class="pre">r'z_\mathrm{b}'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\alpha'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\delta'</span></code>, <code class="docutils literal notranslate"><span class="pre">r'\epsilon'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lumfunc_value</strong> – Predicted Hα-emitter luminosity function value (in inverse
cubic Mpc per flux dex).  Base-10 logarithmic value is returned if
<cite>base10_log</cite> is <cite>True</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is not vectorised.  Please use <cite>numpy.vectorize</cite> or
<cite>functools</cite> if you need vectorisation.</p>
</dd></dl>

<dl class="class">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller">
<em class="property">class </em><code class="sig-prename descclassname">horizonground.lumfunc_modeller.</code><code class="sig-name descname">LumFuncModeller</code><span class="sig-paren">(</span><em class="sig-param">model_lumfunc</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">brightness_variable</em>, <em class="sig-param">threshold_value</em>, <em class="sig-param">normalise_threshold=False</em>, <em class="sig-param">normalisation_redshift=None</em>, <em class="sig-param">cosmology=None</em>, <em class="sig-param">exponentiation=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#LumFuncModeller"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Luminosity function modeller predicting the comoving number
density, evolution bias and magnification bias for a given brightness
threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_lumfunc</strong> (<em>callable</em>) – A parametric luminosity function model as a function of brightness
and redshift (in that order) in units of inverse cubic Mpc.  If it
returns the luminosity function value in base-10 logarithm,
<cite>exponentiation</cite> should be set to <cite>True</cite>; if it accepts a boolean
parameter ‘base10_log’, this will be overriden to <cite>False</cite>.</p></li>
<li><p><strong>model_parameters</strong> (<em>dict</em>) – Model parameters passed to <cite>model_lumfunc</cite> as keyword arguments.</p></li>
<li><p><strong>brightness_variable</strong> (<em>{‘luminosity’, ‘magnitude’}, str</em>) – Brightness variable of <cite>model_lumfunc</cite>, either ‘luminosity’ (in
dex) or ‘magnitude’.</p></li>
<li><p><strong>threshold_value</strong> (<em>float</em>) – Brightness threshold value for <cite>brightness_variable</cite>.  If
<cite>brightness_variable</cite> is ‘luminosity’, this is interpreted as a
flux limit and converted to an intrinsic luminosity value at the
tracer redshift using the luminosity distance.</p></li>
<li><p><strong>normalise_threshold</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default is <cite>False</cite>), <cite>threshold_value</cite> is converted
from a flux limit to a luminosity value at <cite>normalisation_redshift</cite>
using the luminosity distance if <cite>brightness_variable</cite> is
‘luminosity’, or converted from an apparent magnitude limit to
an absolute magnitude value at <cite>normalisation_redshift</cite> using the
distance modulus if <cite>brightness_variable</cite> is ‘magnitude’.</p></li>
<li><p><strong>normalisation_redshift</strong> (<em>float or None, optional</em>) – If not <cite>None</cite> (default) and <cite>normalise_threshold</cite> is <cite>True</cite>, this
redshift is used convert flux or apparent magnitude limit to an
intrinsic luminosity or absolute magnitude threshold.</p></li>
<li><p><strong>cosmology</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.cosmology.core.Cosmology</span></code> or None, optional) – Background cosmological model used to calculate the luminosity
distance or distance modulus (default is <cite>None</cite>).</p></li>
<li><p><strong>exponentiation</strong> (<em>bool, optional</em>) – If <cite>True</cite> (default is <cite>False</cite>), this assumes <cite>model_lumfunc</cite> only
returns the base-10 logarithmic luminosity function and
exponentiate its returned value to a power of 10.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>luminosity_function</strong> (<em>callable</em>) – Luminosity function of brightness and redshift variables only
(in that order) (in inverse cubic <span class="math notranslate nohighlight">\(\mathrm{Mpc}/h\)</span> per unit
luminosity).</p></li>
<li><p><strong>brightness_threshold</strong> (<em>callable</em>) – Intrinsic luminosity or absoloute magnitude threshold, depending
on the input argument of <cite>brightness_variable</cite>, as a function
of redshift.</p></li>
<li><p><strong>cosmology</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.cosmology.core.Cosmology</span></code>) – Background cosmological model.</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Model parameters and luminosity variables stored in a dictionary.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">luminosity_function</span></code> is a vectorised function.</p>
<dl class="attribute">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller.luminosity_bound">
<code class="sig-name descname">luminosity_bound</code><em class="property"> = {'luminosity': 100.0, 'magnitude': -50.0}</em><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller.luminosity_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Finite luminosity upper bound for numerical integration.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">brightness_variable</span></code> is ‘luminosity’, the bound is given as
a base-10 logarithmic flux value in erg/s; else if ‘magnitude’,
the bound is dimensionless.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller.redshift_stepsize">
<code class="sig-name descname">redshift_stepsize</code><em class="property"> = 0.001</em><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller.redshift_stepsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Redshift step size for numerical differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller.from_parameter_file">
<em class="property">classmethod </em><code class="sig-name descname">from_parameter_file</code><span class="sig-paren">(</span><em class="sig-param">parameter_file</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#LumFuncModeller.from_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller.from_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate the modeller class with model parameter values
loaded from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter_file</strong> (<em>str or</em> <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>) – Path of the model parameter file.</p></li>
<li><p><strong>**kwargs</strong> – Parameters other than <cite>model_parameters</cite> passed to the
modeller class as keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller.comoving_number_density">
<code class="sig-name descname">comoving_number_density</code><span class="sig-paren">(</span><em class="sig-param">redshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#LumFuncModeller.comoving_number_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller.comoving_number_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the comoving number density <span class="math notranslate nohighlight">\(\bar{n}(z)\)</span>
above the luminosity threshold at a given redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Comoving number density (in inverse cubic
<span class="math notranslate nohighlight">\(\mathrm{Mpc}/h\)</span>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller.evolution_bias">
<code class="sig-name descname">evolution_bias</code><span class="sig-paren">(</span><em class="sig-param">redshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#LumFuncModeller.evolution_bias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller.evolution_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the evolution bias <span class="math notranslate nohighlight">\(b_\mathrm{e}(z)\)</span> at a
given redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evolution bias.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horizonground.lumfunc_modeller.LumFuncModeller.magnification_bias">
<code class="sig-name descname">magnification_bias</code><span class="sig-paren">(</span><em class="sig-param">redshift</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonground/lumfunc_modeller.html#LumFuncModeller.magnification_bias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonground.lumfunc_modeller.LumFuncModeller.magnification_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the magnification bias <span class="math notranslate nohighlight">\(s(z)\)</span> at a given redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>redshift</strong> (<em>float</em>) – Redshift.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Magnification bias.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy; Copyright 2020, Mike Shengbo Wang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/horizonground.lumfunc_modeller.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>